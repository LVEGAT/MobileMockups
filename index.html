<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Hunter Mobile App</title>

    <link rel="stylesheet" href="styles/kendo.common.min.css"/>
    <link rel="stylesheet" href="styles/kendo.rtl.min.css"/>
    <link rel="stylesheet" href="styles/kendo.silver.min.css"/>
    <link rel="stylesheet" href="styles/kendo.mobile.all.min.css"/>

    <script src="js/jquery.min.js"></script>
    <script src="js/kendo.all.min.js"></script>
    <script src="https://kendo.cdn.telerik.com/2017.3.1026/js/kendo.all.min.js"></script>
</head>
<body>

    <div id = "siteview" data-role="view" data-init="viewInitSite">
        <h2 style="text-align:center ">Sites</h2>
        <ul id="listSite" data-role="listview"  data-click="listViewClick" ></ul>
    </div>

    <div data-role="view" id="controllers" data-init="viewInitCtl" data-stretch="true">
            <a data-role="backbutton">Back</a> <h3 style="text-align:center"> Controllers </h3>
            <div id="gridCtrl"></div>
            <div id="details"></div>
    </div>

    <script>

        var app = new kendo.mobile.Application();
        var wnd,gridConfig,
        detailsTemplate;
        var that = this;

        $(document).ready(function () {
            gridConfig = {
                columns: [
                    { field: "name" },
                    { field: "alarm" },
                    { command: { text: "View Details", click: showDetails } }
                ],
                dataSource: [
                    { name: "Controller 1", alarm: 30 },
                    { name: "Controller 2", alarm: 0 },
                    { name: "Controller 3", alarm: 10 },
                    { name: "Controller 4", alarm: 11 },
                    { name: "Controller 5", alarm: 12 }
                ],
                filterable: true,
                columnMenu: true,
                mobile: "phone",
                height: "auto"
            };

            wnd = $("#details")
                .kendoWindow({
                    title: "Controllers Details",
                    modal: true,
                    visible: false,
                    resizable: false,
                    width: 300
                }).data("kendoWindow");

            detailsTemplate = kendo.template($("#template").html());
        });

        function viewInitSite(e) {
            e.view.element.find("#listSite").kendoMobileListView({
                dataSource: [ "Site1", "Site2", "Site3", "Site4" ],
                filterable: true,
                style : "detaildisclose"
            });
        }

        function viewInitCtl(e) {
            $("#gridCtrl").kendoGrid(gridConfig);
        }
       
        function showDetails(e) {
            e.preventDefault();

            var dataItem = this.dataItem($(e.currentTarget).closest("tr"));
            wnd.content(detailsTemplate(dataItem));
            wnd.center().open();
        }

        function listViewClick(e) {

            console.log(e.item); // The clicked item as a jQuery object
            app.navigate("#controllers", "slide");
        }
        
        new kendo.mobile.Application();
    
    </script>

    <script type="text/x-kendo-template" id="template">
        <div id="details-container">
            <h2>#= name # </h2>
            <em>#= alarm #</em>
            <dl>
                <dt>Alarm: #= alarm #</dt>
              
            </dl>
        </div>
    </script>

    <style type="text/css">
        #details-container {
            padding: 10px;
        }

        #details-container h2 {
            margin: 0;
        }

        #details-container em {
            color: #8c8c8c;
        }

        #details-container dt {
            margin: 0;
            display: inline;
        }
    </style>

    <section data-role="layout" data-id="default">
      <header data-role="header">
        <div data-role="navbar">Hunter</div>
      </header>
      <!--View content will render here-->
      <footer data-role="footer">
        <div data-role="tabstrip">
          <a data-icon="home" href="#home">Home</a>
        </div>
      </footer>
    </section>

    <script>
      var app = new kendo.mobile.Application(document.body);
    </script>
</body>
</html>